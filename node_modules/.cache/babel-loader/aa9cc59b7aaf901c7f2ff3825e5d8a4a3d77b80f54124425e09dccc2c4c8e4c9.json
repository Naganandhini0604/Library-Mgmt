{"ast":null,"code":"'use strict';\n\nconst PromiseProvider = require('../promise_provider');\nconst immediate = require('./immediate');\nconst emittedSymbol = Symbol('mongoose:emitted');\nmodule.exports = function promiseOrCallback(callback, fn, ee, Promise) {\n  if (typeof callback === 'function') {\n    return fn(function (error) {\n      if (error != null) {\n        if (ee != null && ee.listeners != null && ee.listeners('error').length > 0 && !error[emittedSymbol]) {\n          error[emittedSymbol] = true;\n          ee.emit('error', error);\n        }\n        try {\n          callback(error);\n        } catch (error) {\n          return immediate(() => {\n            throw error;\n          });\n        }\n        return;\n      }\n      callback.apply(this, arguments);\n    });\n  }\n  Promise = Promise || PromiseProvider.get();\n  return new Promise((resolve, reject) => {\n    fn(function (error, res) {\n      if (error != null) {\n        if (ee != null && ee.listeners != null && ee.listeners('error').length > 0 && !error[emittedSymbol]) {\n          error[emittedSymbol] = true;\n          ee.emit('error', error);\n        }\n        return reject(error);\n      }\n      if (arguments.length > 2) {\n        return resolve(Array.prototype.slice.call(arguments, 1));\n      }\n      resolve(res);\n    });\n  });\n};","map":{"version":3,"names":["PromiseProvider","require","immediate","emittedSymbol","Symbol","module","exports","promiseOrCallback","callback","fn","ee","Promise","error","listeners","length","emit","apply","arguments","get","resolve","reject","res","Array","prototype","slice","call"],"sources":["/home/ctl/Documents/nodejs/node_modules/mongoose/lib/helpers/promiseOrCallback.js"],"sourcesContent":["'use strict';\n\nconst PromiseProvider = require('../promise_provider');\nconst immediate = require('./immediate');\n\nconst emittedSymbol = Symbol('mongoose:emitted');\n\nmodule.exports = function promiseOrCallback(callback, fn, ee, Promise) {\n  if (typeof callback === 'function') {\n    return fn(function(error) {\n      if (error != null) {\n        if (ee != null && ee.listeners != null && ee.listeners('error').length > 0 && !error[emittedSymbol]) {\n          error[emittedSymbol] = true;\n          ee.emit('error', error);\n        }\n        try {\n          callback(error);\n        } catch (error) {\n          return immediate(() => {\n            throw error;\n          });\n        }\n        return;\n      }\n      callback.apply(this, arguments);\n    });\n  }\n\n  Promise = Promise || PromiseProvider.get();\n\n  return new Promise((resolve, reject) => {\n    fn(function(error, res) {\n      if (error != null) {\n        if (ee != null && ee.listeners != null && ee.listeners('error').length > 0 && !error[emittedSymbol]) {\n          error[emittedSymbol] = true;\n          ee.emit('error', error);\n        }\n        return reject(error);\n      }\n      if (arguments.length > 2) {\n        return resolve(Array.prototype.slice.call(arguments, 1));\n      }\n      resolve(res);\n    });\n  });\n};\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAMA,eAAe,GAAGC,OAAO,CAAC,qBAAqB,CAAC;AACtD,MAAMC,SAAS,GAAGD,OAAO,CAAC,aAAa,CAAC;AAExC,MAAME,aAAa,GAAGC,MAAM,CAAC,kBAAkB,CAAC;AAEhDC,MAAM,CAACC,OAAO,GAAG,SAASC,iBAAiB,CAACC,QAAQ,EAAEC,EAAE,EAAEC,EAAE,EAAEC,OAAO,EAAE;EACrE,IAAI,OAAOH,QAAQ,KAAK,UAAU,EAAE;IAClC,OAAOC,EAAE,CAAC,UAASG,KAAK,EAAE;MACxB,IAAIA,KAAK,IAAI,IAAI,EAAE;QACjB,IAAIF,EAAE,IAAI,IAAI,IAAIA,EAAE,CAACG,SAAS,IAAI,IAAI,IAAIH,EAAE,CAACG,SAAS,CAAC,OAAO,CAAC,CAACC,MAAM,GAAG,CAAC,IAAI,CAACF,KAAK,CAACT,aAAa,CAAC,EAAE;UACnGS,KAAK,CAACT,aAAa,CAAC,GAAG,IAAI;UAC3BO,EAAE,CAACK,IAAI,CAAC,OAAO,EAAEH,KAAK,CAAC;QACzB;QACA,IAAI;UACFJ,QAAQ,CAACI,KAAK,CAAC;QACjB,CAAC,CAAC,OAAOA,KAAK,EAAE;UACd,OAAOV,SAAS,CAAC,MAAM;YACrB,MAAMU,KAAK;UACb,CAAC,CAAC;QACJ;QACA;MACF;MACAJ,QAAQ,CAACQ,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;IACjC,CAAC,CAAC;EACJ;EAEAN,OAAO,GAAGA,OAAO,IAAIX,eAAe,CAACkB,GAAG,EAAE;EAE1C,OAAO,IAAIP,OAAO,CAAC,CAACQ,OAAO,EAAEC,MAAM,KAAK;IACtCX,EAAE,CAAC,UAASG,KAAK,EAAES,GAAG,EAAE;MACtB,IAAIT,KAAK,IAAI,IAAI,EAAE;QACjB,IAAIF,EAAE,IAAI,IAAI,IAAIA,EAAE,CAACG,SAAS,IAAI,IAAI,IAAIH,EAAE,CAACG,SAAS,CAAC,OAAO,CAAC,CAACC,MAAM,GAAG,CAAC,IAAI,CAACF,KAAK,CAACT,aAAa,CAAC,EAAE;UACnGS,KAAK,CAACT,aAAa,CAAC,GAAG,IAAI;UAC3BO,EAAE,CAACK,IAAI,CAAC,OAAO,EAAEH,KAAK,CAAC;QACzB;QACA,OAAOQ,MAAM,CAACR,KAAK,CAAC;MACtB;MACA,IAAIK,SAAS,CAACH,MAAM,GAAG,CAAC,EAAE;QACxB,OAAOK,OAAO,CAACG,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACR,SAAS,EAAE,CAAC,CAAC,CAAC;MAC1D;MACAE,OAAO,CAACE,GAAG,CAAC;IACd,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}