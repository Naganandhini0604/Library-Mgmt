{"ast":null,"code":"'use strict';\n\nmodule.exports = function normalizeRefPath(refPath, doc, populatedPath) {\n  if (refPath == null) {\n    return refPath;\n  }\n  if (typeof refPath === 'function') {\n    refPath = refPath.call(doc, doc, populatedPath);\n  }\n\n  // If populated path has numerics, the end `refPath` should too. For example,\n  // if populating `a.0.b` instead of `a.b` and `b` has `refPath = a.c`, we\n  // should return `a.0.c` for the refPath.\n  const hasNumericProp = /(\\.\\d+$|\\.\\d+\\.)/g;\n  if (hasNumericProp.test(populatedPath)) {\n    const chunks = populatedPath.split(hasNumericProp);\n    if (chunks[chunks.length - 1] === '') {\n      throw new Error('Can\\'t populate individual element in an array');\n    }\n    let _refPath = '';\n    let _remaining = refPath;\n    // 2nd, 4th, etc. will be numeric props. For example: `[ 'a', '.0.', 'b' ]`\n    for (let i = 0; i < chunks.length; i += 2) {\n      const chunk = chunks[i];\n      if (_remaining.startsWith(chunk + '.')) {\n        _refPath += _remaining.substr(0, chunk.length) + chunks[i + 1];\n        _remaining = _remaining.substr(chunk.length + 1);\n      } else if (i === chunks.length - 1) {\n        _refPath += _remaining;\n        _remaining = '';\n        break;\n      } else {\n        throw new Error('Could not normalize ref path, chunk ' + chunk + ' not in populated path');\n      }\n    }\n    return _refPath;\n  }\n  return refPath;\n};","map":{"version":3,"names":["module","exports","normalizeRefPath","refPath","doc","populatedPath","call","hasNumericProp","test","chunks","split","length","Error","_refPath","_remaining","i","chunk","startsWith","substr"],"sources":["/home/ctl/Documents/nodejs/node_modules/mongoose/lib/helpers/populate/normalizeRefPath.js"],"sourcesContent":["'use strict';\n\nmodule.exports = function normalizeRefPath(refPath, doc, populatedPath) {\n  if (refPath == null) {\n    return refPath;\n  }\n\n  if (typeof refPath === 'function') {\n    refPath = refPath.call(doc, doc, populatedPath);\n  }\n\n  // If populated path has numerics, the end `refPath` should too. For example,\n  // if populating `a.0.b` instead of `a.b` and `b` has `refPath = a.c`, we\n  // should return `a.0.c` for the refPath.\n  const hasNumericProp = /(\\.\\d+$|\\.\\d+\\.)/g;\n\n  if (hasNumericProp.test(populatedPath)) {\n    const chunks = populatedPath.split(hasNumericProp);\n\n    if (chunks[chunks.length - 1] === '') {\n      throw new Error('Can\\'t populate individual element in an array');\n    }\n\n    let _refPath = '';\n    let _remaining = refPath;\n    // 2nd, 4th, etc. will be numeric props. For example: `[ 'a', '.0.', 'b' ]`\n    for (let i = 0; i < chunks.length; i += 2) {\n      const chunk = chunks[i];\n      if (_remaining.startsWith(chunk + '.')) {\n        _refPath += _remaining.substr(0, chunk.length) + chunks[i + 1];\n        _remaining = _remaining.substr(chunk.length + 1);\n      } else if (i === chunks.length - 1) {\n        _refPath += _remaining;\n        _remaining = '';\n        break;\n      } else {\n        throw new Error('Could not normalize ref path, chunk ' + chunk + ' not in populated path');\n      }\n    }\n\n    return _refPath;\n  }\n\n  return refPath;\n};"],"mappings":"AAAA,YAAY;;AAEZA,MAAM,CAACC,OAAO,GAAG,SAASC,gBAAgB,CAACC,OAAO,EAAEC,GAAG,EAAEC,aAAa,EAAE;EACtE,IAAIF,OAAO,IAAI,IAAI,EAAE;IACnB,OAAOA,OAAO;EAChB;EAEA,IAAI,OAAOA,OAAO,KAAK,UAAU,EAAE;IACjCA,OAAO,GAAGA,OAAO,CAACG,IAAI,CAACF,GAAG,EAAEA,GAAG,EAAEC,aAAa,CAAC;EACjD;;EAEA;EACA;EACA;EACA,MAAME,cAAc,GAAG,mBAAmB;EAE1C,IAAIA,cAAc,CAACC,IAAI,CAACH,aAAa,CAAC,EAAE;IACtC,MAAMI,MAAM,GAAGJ,aAAa,CAACK,KAAK,CAACH,cAAc,CAAC;IAElD,IAAIE,MAAM,CAACA,MAAM,CAACE,MAAM,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE;MACpC,MAAM,IAAIC,KAAK,CAAC,gDAAgD,CAAC;IACnE;IAEA,IAAIC,QAAQ,GAAG,EAAE;IACjB,IAAIC,UAAU,GAAGX,OAAO;IACxB;IACA,KAAK,IAAIY,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGN,MAAM,CAACE,MAAM,EAAEI,CAAC,IAAI,CAAC,EAAE;MACzC,MAAMC,KAAK,GAAGP,MAAM,CAACM,CAAC,CAAC;MACvB,IAAID,UAAU,CAACG,UAAU,CAACD,KAAK,GAAG,GAAG,CAAC,EAAE;QACtCH,QAAQ,IAAIC,UAAU,CAACI,MAAM,CAAC,CAAC,EAAEF,KAAK,CAACL,MAAM,CAAC,GAAGF,MAAM,CAACM,CAAC,GAAG,CAAC,CAAC;QAC9DD,UAAU,GAAGA,UAAU,CAACI,MAAM,CAACF,KAAK,CAACL,MAAM,GAAG,CAAC,CAAC;MAClD,CAAC,MAAM,IAAII,CAAC,KAAKN,MAAM,CAACE,MAAM,GAAG,CAAC,EAAE;QAClCE,QAAQ,IAAIC,UAAU;QACtBA,UAAU,GAAG,EAAE;QACf;MACF,CAAC,MAAM;QACL,MAAM,IAAIF,KAAK,CAAC,sCAAsC,GAAGI,KAAK,GAAG,wBAAwB,CAAC;MAC5F;IACF;IAEA,OAAOH,QAAQ;EACjB;EAEA,OAAOV,OAAO;AAChB,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}