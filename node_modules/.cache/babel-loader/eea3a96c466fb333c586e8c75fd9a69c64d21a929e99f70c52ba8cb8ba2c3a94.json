{"ast":null,"code":"'use strict';\n\n/**\n * MongoDB throws an error if there's unused array filters. That is, if `options.arrayFilters` defines\n * a filter, but none of the `update` keys use it. This should be enough to filter out all unused array\n * filters.\n */\nmodule.exports = function removeUnusedArrayFilters(update, arrayFilters) {\n  const updateKeys = Object.keys(update).map(key => Object.keys(update[key])).reduce((cur, arr) => cur.concat(arr), []);\n  return arrayFilters.filter(obj => {\n    const firstKey = Object.keys(obj)[0];\n    const firstDot = firstKey.indexOf('.');\n    const arrayFilterKey = firstDot === -1 ? firstKey : firstKey.slice(0, firstDot);\n    return updateKeys.find(key => key.includes('$[' + arrayFilterKey + ']')) != null;\n  });\n};","map":{"version":3,"names":["module","exports","removeUnusedArrayFilters","update","arrayFilters","updateKeys","Object","keys","map","key","reduce","cur","arr","concat","filter","obj","firstKey","firstDot","indexOf","arrayFilterKey","slice","find","includes"],"sources":["/home/ctl/Documents/nodejs/node_modules/mongoose/lib/helpers/update/removeUnusedArrayFilters.js"],"sourcesContent":["'use strict';\n\n/**\n * MongoDB throws an error if there's unused array filters. That is, if `options.arrayFilters` defines\n * a filter, but none of the `update` keys use it. This should be enough to filter out all unused array\n * filters.\n */\n\nmodule.exports = function removeUnusedArrayFilters(update, arrayFilters) {\n  const updateKeys = Object.keys(update).map(key => Object.keys(update[key])).reduce((cur, arr) => cur.concat(arr), []);\n  return arrayFilters.filter(obj => {\n    const firstKey = Object.keys(obj)[0];\n    const firstDot = firstKey.indexOf('.');\n    const arrayFilterKey = firstDot === -1 ? firstKey : firstKey.slice(0, firstDot);\n\n    return updateKeys.find(key => key.includes('$[' + arrayFilterKey + ']')) != null;\n  });\n};"],"mappings":"AAAA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AAEAA,MAAM,CAACC,OAAO,GAAG,SAASC,wBAAwB,CAACC,MAAM,EAAEC,YAAY,EAAE;EACvE,MAAMC,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACJ,MAAM,CAAC,CAACK,GAAG,CAACC,GAAG,IAAIH,MAAM,CAACC,IAAI,CAACJ,MAAM,CAACM,GAAG,CAAC,CAAC,CAAC,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAKD,GAAG,CAACE,MAAM,CAACD,GAAG,CAAC,EAAE,EAAE,CAAC;EACrH,OAAOR,YAAY,CAACU,MAAM,CAACC,GAAG,IAAI;IAChC,MAAMC,QAAQ,GAAGV,MAAM,CAACC,IAAI,CAACQ,GAAG,CAAC,CAAC,CAAC,CAAC;IACpC,MAAME,QAAQ,GAAGD,QAAQ,CAACE,OAAO,CAAC,GAAG,CAAC;IACtC,MAAMC,cAAc,GAAGF,QAAQ,KAAK,CAAC,CAAC,GAAGD,QAAQ,GAAGA,QAAQ,CAACI,KAAK,CAAC,CAAC,EAAEH,QAAQ,CAAC;IAE/E,OAAOZ,UAAU,CAACgB,IAAI,CAACZ,GAAG,IAAIA,GAAG,CAACa,QAAQ,CAAC,IAAI,GAAGH,cAAc,GAAG,GAAG,CAAC,CAAC,IAAI,IAAI;EAClF,CAAC,CAAC;AACJ,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}