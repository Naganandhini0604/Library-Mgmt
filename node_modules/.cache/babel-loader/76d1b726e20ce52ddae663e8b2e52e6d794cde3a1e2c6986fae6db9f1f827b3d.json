{"ast":null,"code":"'use strict';\n\nconst getDiscriminatorByValue = require('../../helpers/discriminator/getDiscriminatorByValue');\nconst applyTimestampsToChildren = require('../update/applyTimestampsToChildren');\nconst applyTimestampsToUpdate = require('../update/applyTimestampsToUpdate');\nconst cast = require('../../cast');\nconst castUpdate = require('../query/castUpdate');\nconst setDefaultsOnInsert = require('../setDefaultsOnInsert');\n\n/*!\n * Given a model and a bulkWrite op, return a thunk that handles casting and\n * validating the individual op.\n */\n\nmodule.exports = function castBulkWrite(originalModel, op, options) {\n  const now = originalModel.base.now();\n  if (op['insertOne']) {\n    return callback => {\n      const model = decideModelByObject(originalModel, op['insertOne']['document']);\n      const doc = new model(op['insertOne']['document']);\n      if (model.schema.options.timestamps) {\n        doc.initializeTimestamps();\n      }\n      if (options.session != null) {\n        doc.$session(options.session);\n      }\n      op['insertOne']['document'] = doc;\n      op['insertOne']['document'].validate({\n        __noPromise: true\n      }, function (error) {\n        if (error) {\n          return callback(error, null);\n        }\n        callback(null);\n      });\n    };\n  } else if (op['updateOne']) {\n    return callback => {\n      try {\n        if (!op['updateOne']['filter']) {\n          throw new Error('Must provide a filter object.');\n        }\n        if (!op['updateOne']['update']) {\n          throw new Error('Must provide an update object.');\n        }\n        const model = decideModelByObject(originalModel, op['updateOne']['filter']);\n        const schema = model.schema;\n        const strict = options.strict != null ? options.strict : model.schema.options.strict;\n        _addDiscriminatorToObject(schema, op['updateOne']['filter']);\n        if (model.schema.$timestamps != null && op['updateOne'].timestamps !== false) {\n          const createdAt = model.schema.$timestamps.createdAt;\n          const updatedAt = model.schema.$timestamps.updatedAt;\n          applyTimestampsToUpdate(now, createdAt, updatedAt, op['updateOne']['update'], {});\n        }\n        applyTimestampsToChildren(now, op['updateOne']['update'], model.schema);\n        if (op['updateOne'].setDefaultsOnInsert) {\n          setDefaultsOnInsert(op['updateOne']['filter'], model.schema, op['updateOne']['update'], {\n            setDefaultsOnInsert: true,\n            upsert: op['updateOne'].upsert\n          });\n        }\n        op['updateOne']['filter'] = cast(model.schema, op['updateOne']['filter'], {\n          strict: strict,\n          upsert: op['updateOne'].upsert\n        });\n        op['updateOne']['update'] = castUpdate(model.schema, op['updateOne']['update'], {\n          strict: strict,\n          overwrite: false,\n          upsert: op['updateOne'].upsert\n        }, model, op['updateOne']['filter']);\n      } catch (error) {\n        return callback(error, null);\n      }\n      callback(null);\n    };\n  } else if (op['updateMany']) {\n    return callback => {\n      try {\n        if (!op['updateMany']['filter']) {\n          throw new Error('Must provide a filter object.');\n        }\n        if (!op['updateMany']['update']) {\n          throw new Error('Must provide an update object.');\n        }\n        const model = decideModelByObject(originalModel, op['updateMany']['filter']);\n        const schema = model.schema;\n        const strict = options.strict != null ? options.strict : model.schema.options.strict;\n        if (op['updateMany'].setDefaultsOnInsert) {\n          setDefaultsOnInsert(op['updateMany']['filter'], model.schema, op['updateMany']['update'], {\n            setDefaultsOnInsert: true,\n            upsert: op['updateMany'].upsert\n          });\n        }\n        if (model.schema.$timestamps != null && op['updateMany'].timestamps !== false) {\n          const createdAt = model.schema.$timestamps.createdAt;\n          const updatedAt = model.schema.$timestamps.updatedAt;\n          applyTimestampsToUpdate(now, createdAt, updatedAt, op['updateMany']['update'], {});\n        }\n        applyTimestampsToChildren(now, op['updateMany']['update'], model.schema);\n        _addDiscriminatorToObject(schema, op['updateMany']['filter']);\n        op['updateMany']['filter'] = cast(model.schema, op['updateMany']['filter'], {\n          strict: strict,\n          upsert: op['updateMany'].upsert\n        });\n        op['updateMany']['update'] = castUpdate(model.schema, op['updateMany']['update'], {\n          strict: strict,\n          overwrite: false,\n          upsert: op['updateMany'].upsert\n        }, model, op['updateMany']['filter']);\n      } catch (error) {\n        return callback(error, null);\n      }\n      callback(null);\n    };\n  } else if (op['replaceOne']) {\n    return callback => {\n      const model = decideModelByObject(originalModel, op['replaceOne']['filter']);\n      const schema = model.schema;\n      const strict = options.strict != null ? options.strict : model.schema.options.strict;\n      _addDiscriminatorToObject(schema, op['replaceOne']['filter']);\n      try {\n        op['replaceOne']['filter'] = cast(model.schema, op['replaceOne']['filter'], {\n          strict: strict,\n          upsert: op['replaceOne'].upsert\n        });\n      } catch (error) {\n        return callback(error, null);\n      }\n\n      // set `skipId`, otherwise we get \"_id field cannot be changed\"\n      const doc = new model(op['replaceOne']['replacement'], strict, true);\n      if (model.schema.options.timestamps) {\n        doc.initializeTimestamps();\n      }\n      if (options.session != null) {\n        doc.$session(options.session);\n      }\n      op['replaceOne']['replacement'] = doc;\n      op['replaceOne']['replacement'].validate({\n        __noPromise: true\n      }, function (error) {\n        if (error) {\n          return callback(error, null);\n        }\n        op['replaceOne']['replacement'] = op['replaceOne']['replacement'].toBSON();\n        callback(null);\n      });\n    };\n  } else if (op['deleteOne']) {\n    return callback => {\n      const model = decideModelByObject(originalModel, op['deleteOne']['filter']);\n      const schema = model.schema;\n      _addDiscriminatorToObject(schema, op['deleteOne']['filter']);\n      try {\n        op['deleteOne']['filter'] = cast(model.schema, op['deleteOne']['filter']);\n      } catch (error) {\n        return callback(error, null);\n      }\n      callback(null);\n    };\n  } else if (op['deleteMany']) {\n    return callback => {\n      const model = decideModelByObject(originalModel, op['deleteMany']['filter']);\n      const schema = model.schema;\n      _addDiscriminatorToObject(schema, op['deleteMany']['filter']);\n      try {\n        op['deleteMany']['filter'] = cast(model.schema, op['deleteMany']['filter']);\n      } catch (error) {\n        return callback(error, null);\n      }\n      callback(null);\n    };\n  } else {\n    return callback => {\n      callback(new Error('Invalid op passed to `bulkWrite()`'), null);\n    };\n  }\n};\nfunction _addDiscriminatorToObject(schema, obj) {\n  if (schema == null) {\n    return;\n  }\n  if (schema.discriminatorMapping && !schema.discriminatorMapping.isRoot) {\n    obj[schema.discriminatorMapping.key] = schema.discriminatorMapping.value;\n  }\n}\n\n/*!\n * gets discriminator model if discriminator key is present in object\n */\n\nfunction decideModelByObject(model, object) {\n  const discriminatorKey = model.schema.options.discriminatorKey;\n  if (object != null && object.hasOwnProperty(discriminatorKey)) {\n    model = getDiscriminatorByValue(model.discriminators, object[discriminatorKey]) || model;\n  }\n  return model;\n}","map":{"version":3,"names":["getDiscriminatorByValue","require","applyTimestampsToChildren","applyTimestampsToUpdate","cast","castUpdate","setDefaultsOnInsert","module","exports","castBulkWrite","originalModel","op","options","now","base","callback","model","decideModelByObject","doc","schema","timestamps","initializeTimestamps","session","$session","validate","__noPromise","error","Error","strict","_addDiscriminatorToObject","$timestamps","createdAt","updatedAt","upsert","overwrite","toBSON","obj","discriminatorMapping","isRoot","key","value","object","discriminatorKey","hasOwnProperty","discriminators"],"sources":["/home/ctl/Documents/nodejs/node_modules/mongoose/lib/helpers/model/castBulkWrite.js"],"sourcesContent":["'use strict';\n\nconst getDiscriminatorByValue = require('../../helpers/discriminator/getDiscriminatorByValue');\nconst applyTimestampsToChildren = require('../update/applyTimestampsToChildren');\nconst applyTimestampsToUpdate = require('../update/applyTimestampsToUpdate');\nconst cast = require('../../cast');\nconst castUpdate = require('../query/castUpdate');\nconst setDefaultsOnInsert = require('../setDefaultsOnInsert');\n\n/*!\n * Given a model and a bulkWrite op, return a thunk that handles casting and\n * validating the individual op.\n */\n\nmodule.exports = function castBulkWrite(originalModel, op, options) {\n  const now = originalModel.base.now();\n\n  if (op['insertOne']) {\n    return (callback) => {\n      const model = decideModelByObject(originalModel, op['insertOne']['document']);\n\n      const doc = new model(op['insertOne']['document']);\n      if (model.schema.options.timestamps) {\n        doc.initializeTimestamps();\n      }\n      if (options.session != null) {\n        doc.$session(options.session);\n      }\n      op['insertOne']['document'] = doc;\n      op['insertOne']['document'].validate({ __noPromise: true }, function(error) {\n        if (error) {\n          return callback(error, null);\n        }\n        callback(null);\n      });\n    };\n  } else if (op['updateOne']) {\n    return (callback) => {\n      try {\n        if (!op['updateOne']['filter']) {\n          throw new Error('Must provide a filter object.');\n        }\n        if (!op['updateOne']['update']) {\n          throw new Error('Must provide an update object.');\n        }\n\n        const model = decideModelByObject(originalModel, op['updateOne']['filter']);\n        const schema = model.schema;\n        const strict = options.strict != null ? options.strict : model.schema.options.strict;\n\n        _addDiscriminatorToObject(schema, op['updateOne']['filter']);\n\n        if (model.schema.$timestamps != null && op['updateOne'].timestamps !== false) {\n          const createdAt = model.schema.$timestamps.createdAt;\n          const updatedAt = model.schema.$timestamps.updatedAt;\n          applyTimestampsToUpdate(now, createdAt, updatedAt, op['updateOne']['update'], {});\n        }\n\n        applyTimestampsToChildren(now, op['updateOne']['update'], model.schema);\n\n        if (op['updateOne'].setDefaultsOnInsert) {\n          setDefaultsOnInsert(op['updateOne']['filter'], model.schema, op['updateOne']['update'], {\n            setDefaultsOnInsert: true,\n            upsert: op['updateOne'].upsert\n          });\n        }\n\n        op['updateOne']['filter'] = cast(model.schema, op['updateOne']['filter'], {\n          strict: strict,\n          upsert: op['updateOne'].upsert\n        });\n\n        op['updateOne']['update'] = castUpdate(model.schema, op['updateOne']['update'], {\n          strict: strict,\n          overwrite: false,\n          upsert: op['updateOne'].upsert\n        }, model, op['updateOne']['filter']);\n      } catch (error) {\n        return callback(error, null);\n      }\n\n      callback(null);\n    };\n  } else if (op['updateMany']) {\n    return (callback) => {\n      try {\n        if (!op['updateMany']['filter']) {\n          throw new Error('Must provide a filter object.');\n        }\n        if (!op['updateMany']['update']) {\n          throw new Error('Must provide an update object.');\n        }\n\n        const model = decideModelByObject(originalModel, op['updateMany']['filter']);\n        const schema = model.schema;\n        const strict = options.strict != null ? options.strict : model.schema.options.strict;\n\n        if (op['updateMany'].setDefaultsOnInsert) {\n          setDefaultsOnInsert(op['updateMany']['filter'], model.schema, op['updateMany']['update'], {\n            setDefaultsOnInsert: true,\n            upsert: op['updateMany'].upsert\n          });\n        }\n\n        if (model.schema.$timestamps != null && op['updateMany'].timestamps !== false) {\n          const createdAt = model.schema.$timestamps.createdAt;\n          const updatedAt = model.schema.$timestamps.updatedAt;\n          applyTimestampsToUpdate(now, createdAt, updatedAt, op['updateMany']['update'], {});\n        }\n\n        applyTimestampsToChildren(now, op['updateMany']['update'], model.schema);\n\n        _addDiscriminatorToObject(schema, op['updateMany']['filter']);\n\n        op['updateMany']['filter'] = cast(model.schema, op['updateMany']['filter'], {\n          strict: strict,\n          upsert: op['updateMany'].upsert\n        });\n\n        op['updateMany']['update'] = castUpdate(model.schema, op['updateMany']['update'], {\n          strict: strict,\n          overwrite: false,\n          upsert: op['updateMany'].upsert\n        }, model, op['updateMany']['filter']);\n\n      } catch (error) {\n        return callback(error, null);\n      }\n\n      callback(null);\n    };\n  } else if (op['replaceOne']) {\n    return (callback) => {\n      const model = decideModelByObject(originalModel, op['replaceOne']['filter']);\n      const schema = model.schema;\n      const strict = options.strict != null ? options.strict : model.schema.options.strict;\n\n      _addDiscriminatorToObject(schema, op['replaceOne']['filter']);\n      try {\n        op['replaceOne']['filter'] = cast(model.schema, op['replaceOne']['filter'], {\n          strict: strict,\n          upsert: op['replaceOne'].upsert\n        });\n      } catch (error) {\n        return callback(error, null);\n      }\n\n      // set `skipId`, otherwise we get \"_id field cannot be changed\"\n      const doc = new model(op['replaceOne']['replacement'], strict, true);\n      if (model.schema.options.timestamps) {\n        doc.initializeTimestamps();\n      }\n      if (options.session != null) {\n        doc.$session(options.session);\n      }\n      op['replaceOne']['replacement'] = doc;\n\n      op['replaceOne']['replacement'].validate({ __noPromise: true }, function(error) {\n        if (error) {\n          return callback(error, null);\n        }\n        op['replaceOne']['replacement'] = op['replaceOne']['replacement'].toBSON();\n        callback(null);\n      });\n    };\n  } else if (op['deleteOne']) {\n    return (callback) => {\n      const model = decideModelByObject(originalModel, op['deleteOne']['filter']);\n      const schema = model.schema;\n\n      _addDiscriminatorToObject(schema, op['deleteOne']['filter']);\n\n      try {\n        op['deleteOne']['filter'] = cast(model.schema,\n          op['deleteOne']['filter']);\n      } catch (error) {\n        return callback(error, null);\n      }\n\n      callback(null);\n    };\n  } else if (op['deleteMany']) {\n    return (callback) => {\n      const model = decideModelByObject(originalModel, op['deleteMany']['filter']);\n      const schema = model.schema;\n\n      _addDiscriminatorToObject(schema, op['deleteMany']['filter']);\n\n      try {\n        op['deleteMany']['filter'] = cast(model.schema,\n          op['deleteMany']['filter']);\n      } catch (error) {\n        return callback(error, null);\n      }\n\n      callback(null);\n    };\n  } else {\n    return (callback) => {\n      callback(new Error('Invalid op passed to `bulkWrite()`'), null);\n    };\n  }\n};\n\nfunction _addDiscriminatorToObject(schema, obj) {\n  if (schema == null) {\n    return;\n  }\n  if (schema.discriminatorMapping && !schema.discriminatorMapping.isRoot) {\n    obj[schema.discriminatorMapping.key] = schema.discriminatorMapping.value;\n  }\n}\n\n/*!\n * gets discriminator model if discriminator key is present in object\n */\n\nfunction decideModelByObject(model, object) {\n  const discriminatorKey = model.schema.options.discriminatorKey;\n  if (object != null && object.hasOwnProperty(discriminatorKey)) {\n    model = getDiscriminatorByValue(model.discriminators, object[discriminatorKey]) || model;\n  }\n  return model;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}